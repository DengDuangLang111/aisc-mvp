# âš¡ Study Oasis å¿«é€Ÿä¿®å¤æŒ‡å—\n\n**ç›®æ ‡**ï¼šåœ¨ä»Šå¤©ä¿®å¤å¯¹è¯ä¸Šä¸‹æ–‡é—®é¢˜  \n**é¢„è®¡æ—¶é—´**ï¼š30-45 åˆ†é’Ÿ  \n**éš¾åº¦**ï¼šâ­ ç®€å•\n\n---\n\n## ğŸ¯ é—®é¢˜æ¦‚è¿°\n\n### å½“å‰ç—‡çŠ¶\n- âŒ ç”¨æˆ·åœ¨å¯¹è¯ä¸­è¿ç»­æé—®ï¼Œä½†æ¯æ¡æ¶ˆæ¯ä¼¼ä¹éƒ½æ˜¯ç‹¬ç«‹çš„\n- âŒ AI æ— æ³•çœ‹åˆ°ä¹‹å‰çš„å¯¹è¯å†å²\n- âŒ å¯¹è¯ç•Œé¢ä¸æ˜¾ç¤ºå†å²æ¶ˆæ¯\n\n### æ ¹æœ¬åŸå› \n**å‰ç«¯é—®é¢˜**ï¼š`/apps/web/app/chat/page.tsx` æ²¡æœ‰ï¼š\n1. ç»´æŠ¤ `conversationId` çŠ¶æ€\n2. åŠ è½½å®Œæ•´çš„å¯¹è¯å†å²\n3. æ­£ç¡®ä¼ é€’ä¼šè¯ ID åˆ°åç«¯\n\n**åç«¯çŠ¶æ€**ï¼šâœ… åç«¯ä»£ç å®Œå…¨æ­£ç¡®ï¼Œå¯ä»¥æ­£å¸¸åŠ è½½å†å²æ¶ˆæ¯\n\n---\n\n## ğŸ” è¯Šæ–­æ­¥éª¤ï¼ˆ5 åˆ†é’Ÿï¼‰\n\n### 1. æ£€æŸ¥åç«¯æ˜¯å¦æ­£å¸¸\n\n```bash\n# ç»ˆç«¯è¿è¡Œ\ncurl -X POST http://localhost:4001/chat \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\"message\":\"æµ‹è¯• 1\"}'  \n\n# åº”è¯¥è¿”å›ï¼šconversationIdã€replyã€hintLevel\n# ä¿å­˜ conversationIdï¼Œæ¯”å¦‚ï¼š6346df2e-5d3e-4460-a789-95ff3def12ef\n```\n\n### 2. æµ‹è¯•å¯¹è¯å†å²åŠ è½½\n\n```bash\n# ä½¿ç”¨ä¸Šä¸€æ­¥çš„ conversationId\nCONV_ID=\"6346df2e-5d3e-4460-a789-95ff3def12ef\"\n\n# ç¬¬äºŒæ¡æ¶ˆæ¯ï¼Œå¸¦ä¸Š conversationId\ncurl -X POST http://localhost:4001/chat \\\n  -H \"Content-Type: application/json\" \\\n  -d \"{\\\"message\\\":\\\"æµ‹è¯• 2\\\",\\\"conversationId\\\":\\\"$CONV_ID\\\"}\"\n\n# åº”è¯¥è¿”å›ç›¸åŒçš„ conversationId\n```\n\n### 3. æŸ¥çœ‹å¯¹è¯è¯¦æƒ…\n\n```bash\n# è·å–å®Œæ•´å¯¹è¯å†å²\ncurl http://localhost:4001/chat/conversations/$CONV_ID\n\n# åº”è¯¥è¿”å›ï¼šmessages æ•°ç»„ï¼ŒåŒ…å«æ‰€æœ‰å†å²æ¶ˆæ¯\n```\n\nâœ… **å¦‚æœä¸Šé¢ä¸‰ä¸ªå‘½ä»¤éƒ½æˆåŠŸï¼Œè¯´æ˜åç«¯å®Œå…¨æ­£å¸¸ï¼**\n\n---\n\n## ğŸ› ï¸ ä¿®å¤æ–¹æ¡ˆï¼ˆ25-35 åˆ†é’Ÿï¼‰\n\n### æ­¥éª¤ 1ï¼šæŸ¥çœ‹å½“å‰å¯¹è¯é¡µé¢\n\næ‰“å¼€æ–‡ä»¶ï¼š`/apps/web/app/chat/page.tsx`\n\n```typescript\n// çœ‹çœ‹å½“å‰ä»£ç æ˜¯ä»€ä¹ˆæ ·çš„\n'use client';\n\nexport default function ChatPage() {\n  // ...\n}\n```\n\n### æ­¥éª¤ 2ï¼šæ·»åŠ å¯¹è¯çŠ¶æ€ç®¡ç†\n\n**å®Œæ•´ä¿®å¤ä»£ç **ï¼š\n\n```typescript\n'use client';\n\nimport { useState, useEffect } from 'react';\n\ninterface Message {\n  role: 'user' | 'assistant';\n  content: string;\n  timestamp?: number;\n  hintLevel?: number;\n}\n\nexport default function ChatPage() {\n  // çŠ¶æ€ç®¡ç†\n  const [messages, setMessages] = useState<Message[]>([]);\n  const [inputValue, setInputValue] = useState('');\n  const [conversationId, setConversationId] = useState<string | null>(null);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n\n  // ä» URL å‚æ•°æˆ–æœ¬åœ°å­˜å‚¨è·å– conversationId\n  useEffect(() => {\n    const params = new URLSearchParams(window.location.search);\n    const id = params.get('conversationId');\n    if (id) {\n      setConversationId(id);\n      loadConversationHistory(id);\n    }\n  }, []);\n\n  // åŠ è½½å¯¹è¯å†å²\n  const loadConversationHistory = async (id: string) => {\n    try {\n      const response = await fetch(`/chat/conversations/${id}`);\n      if (!response.ok) throw new Error('Failed to load history');\n      const data = await response.json();\n      \n      // è½¬æ¢æ¶ˆæ¯æ ¼å¼\n      const formattedMessages: Message[] = data.messages.map((msg: any) => ({\n        role: msg.role,\n        content: msg.content,\n        timestamp: msg.createdAt,\n      }));\n      setMessages(formattedMessages);\n    } catch (err) {\n      console.error('Error loading history:', err);\n      setError('Failed to load conversation history');\n    }\n  };\n\n  // å‘é€æ¶ˆæ¯\n  const handleSendMessage = async () => {\n    if (!inputValue.trim()) return;\n\n    setLoading(true);\n    setError(null);\n\n    try {\n      // æ·»åŠ ç”¨æˆ·æ¶ˆæ¯åˆ°æœ¬åœ°\n      const userMessage: Message = {\n        role: 'user',\n        content: inputValue,\n        timestamp: Date.now(),\n      };\n      setMessages(prev => [...prev, userMessage]);\n      setInputValue('');\n\n      // è°ƒç”¨ API\n      const response = await fetch('/chat', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({\n          message: inputValue,\n          conversationId: conversationId || undefined,\n        }),\n      });\n\n      if (!response.ok) throw new Error('API Error');\n      const data = await response.json();\n\n      // ä¿å­˜è¿”å›çš„ conversationId\n      if (!conversationId && data.conversationId) {\n        setConversationId(data.conversationId);\n        // æ›´æ–° URL\n        window.history.pushState(\n          {},\n          '',\n          `/chat?conversationId=${data.conversationId}`\n        );\n      }\n\n      // æ·»åŠ  AI å›å¤\n      const assistantMessage: Message = {\n        role: 'assistant',\n        content: data.reply,\n        timestamp: data.timestamp,\n        hintLevel: data.hintLevel,\n      };\n      setMessages(prev => [...prev, assistantMessage]);\n    } catch (err) {\n      setError(err instanceof Error ? err.message : 'Unknown error');\n      // ç§»é™¤å¤±è´¥çš„ç”¨æˆ·æ¶ˆæ¯\n      setMessages(prev => prev.slice(0, -1));\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  return (\n    <div className=\"flex flex-col h-screen bg-gray-50\">\n      {/* æ ‡é¢˜ */}\n      <div className=\"bg-white border-b border-gray-200 px-6 py-4\">\n        <h1 className=\"text-2xl font-bold text-gray-900\">\n          AI å­¦ä¹ åŠ©æ‰‹\n          {conversationId && (\n            <span className=\"text-sm font-normal text-gray-500 ml-4\">\n              ID: {conversationId.slice(0, 8)}...\n            </span>\n          )}\n        </h1>\n      </div>\n\n      {/* æ¶ˆæ¯åˆ—è¡¨ */}\n      <div className=\"flex-1 overflow-y-auto px-6 py-4 space-y-4\">\n        {messages.length === 0 ? (\n          <div className=\"text-center text-gray-400 py-12\">\n            <p>å¼€å§‹å¯¹è¯å§ï¼æå‡ºä½ çš„é—®é¢˜...</p>\n          </div>\n        ) : (\n          messages.map((msg, idx) => (\n            <div\n              key={idx}\n              className={`flex ${msg.role === 'user' ? 'justify-end' : 'justify-start'}`}\n            >\n              <div\n                className={`max-w-xs lg:max-w-md px-4 py-2 rounded-lg ${\n                  msg.role === 'user'\n                    ? 'bg-blue-600 text-white'\n                    : 'bg-gray-200 text-gray-900'\n                }`}\n              >\n                <p>{msg.content}</p>\n                {msg.hintLevel && (\n                  <p className=\"text-xs mt-1 opacity-70\">\n                    Level {msg.hintLevel}\n                  </p>\n                )}\n              </div>\n            </div>\n          ))\n        )}\n        {loading && (\n          <div className=\"flex justify-start\">\n            <div className=\"bg-gray-200 px-4 py-2 rounded-lg text-gray-600\">\n              æ­£åœ¨æ€è€ƒ...\n            </div>\n          </div>\n        )}\n      </div>\n\n      {/* é”™è¯¯æç¤º */}\n      {error && (\n        <div className=\"bg-red-50 border-l-4 border-red-500 p-4 mx-6\">\n          <p className=\"text-red-700\">{error}</p>\n        </div>\n      )}\n\n      {/* è¾“å…¥æ¡† */}\n      <div className=\"bg-white border-t border-gray-200 px-6 py-4\">\n        <div className=\"flex gap-2\">\n          <input\n            type=\"text\"\n            value={inputValue}\n            onChange={(e) => setInputValue(e.target.value)}\n            onKeyPress={(e) => e.key === 'Enter' && handleSendMessage()}\n            placeholder=\"è¾“å…¥ä½ çš„é—®é¢˜...\"\n            className=\"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500\"\n            disabled={loading}\n          />\n          <button\n            onClick={handleSendMessage}\n            disabled={loading || !inputValue.trim()}\n            className=\"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed\"\n          >\n            {loading ? 'å‘é€ä¸­...' : 'å‘é€'}\n          </button>\n        </div>\n      </div>\n    </div>\n  );\n}\n```\n\n### æ­¥éª¤ 3ï¼šæ›¿æ¢åŸæ–‡ä»¶\n\n1. æ‰“å¼€ `/apps/web/app/chat/page.tsx`\n2. å°†æ•´ä¸ªå†…å®¹æ›¿æ¢ä¸ºä¸Šé¢çš„ä»£ç \n3. ä¿å­˜æ–‡ä»¶\n\n### æ­¥éª¤ 4ï¼šéªŒè¯ä¿®å¤\n\n```bash\n# 1. ç¡®ä¿å‰ç«¯å·²ä¿å­˜\nls -la /apps/web/app/chat/page.tsx\n\n# 2. æ£€æŸ¥å‰ç«¯æ˜¯å¦æ­£åœ¨è¿è¡Œï¼ˆåº”è¯¥è‡ªåŠ¨é‡æ–°åŠ è½½ï¼‰\n# è®¿é—® http://localhost:3000/chat\n\n# 3. æµ‹è¯•ï¼š\n# - è¾“å…¥ç¬¬ä¸€æ¡æ¶ˆæ¯\n# - éªŒè¯æ˜¯å¦è¿”å› conversationId\n# - è¾“å…¥ç¬¬äºŒæ¡æ¶ˆæ¯\n# - éªŒè¯èƒ½å¦çœ‹åˆ°ç¬¬ä¸€æ¡æ¶ˆæ¯\n```\n\n---\n\n## âœ… éªŒæ”¶æ ‡å‡†\n\nä¿®å¤æˆåŠŸçš„æ ‡å¿—ï¼š\n\n- âœ… ç”¨æˆ·èƒ½åœ¨å¯¹è¯æ¡†ä¸­çœ‹åˆ°å®Œæ•´çš„å¯¹è¯å†å²\n- âœ… æ¯æ¡ç”¨æˆ·æ¶ˆæ¯éƒ½æ˜¾ç¤ºåœ¨å†å²ä¸­\n- âœ… æ¯æ¡ AI å›å¤éƒ½æ˜¾ç¤ºåœ¨å†å²ä¸­  \n- âœ… åˆ·æ–°é¡µé¢åï¼Œå¯¹è¯å†å²ä»ç„¶å¯è§\n- âœ… èƒ½çœ‹åˆ° Hint Level æŒ‡ç¤ºå™¨\n- âœ… URL ä¸­åŒ…å« `conversationId` å‚æ•°\n- âœ… å¯ä»¥åœ¨å¤šä¸ªæµè§ˆå™¨æ ‡ç­¾é¡µæ‰“å¼€åŒä¸€å¯¹è¯\n\n---\n\n## ğŸ› å¸¸è§é—®é¢˜æ’æŸ¥\n\n### é—®é¢˜ï¼šåˆ·æ–°åå¯¹è¯æ¶ˆå¤±\n**åŸå› **ï¼šURL ä¸­æ²¡æœ‰ conversationId  \n**è§£å†³**ï¼šç¡®ä¿ä»£ç ä¸­æœ‰ `window.history.pushState` è¡Œ\n\n### é—®é¢˜ï¼šAI çœ‹ä¸åˆ°å†å²æ¶ˆæ¯\n**åŸå› **ï¼šå¯èƒ½æ²¡æœ‰ä¼ é€’ conversationId  \n**æ£€æŸ¥**ï¼šæ‰“å¼€æµè§ˆå™¨æ§åˆ¶å°ï¼ŒæŸ¥çœ‹ Network æ ‡ç­¾ï¼Œæ£€æŸ¥è¯·æ±‚æ˜¯å¦åŒ…å« conversationId\n\n### é—®é¢˜ï¼šæ¶ˆæ¯æ˜¾ç¤ºä¸¤æ¬¡\n**åŸå› **ï¼šå¯èƒ½åœ¨ StrictMode ä¸‹é‡æ–°æ¸²æŸ“  \n**è§£å†³**ï¼šè¿™æ˜¯æ­£å¸¸çš„ï¼Œç”Ÿäº§ç¯å¢ƒä¸ä¼šå‘ç”Ÿ\n\n---\n\n## ğŸ“ éœ€è¦å¸®åŠ©ï¼Ÿ\n\nå¦‚æœä¿®å¤è¿‡ç¨‹ä¸­é‡åˆ°é—®é¢˜ï¼š\n\n1. æ£€æŸ¥ `/apps/web/app/chat/page.tsx` æ–‡ä»¶æ˜¯å¦æ­£ç¡®ä¿å­˜\n2. æ‰“å¼€æµè§ˆå™¨æ§åˆ¶å°æ£€æŸ¥é”™è¯¯æ—¥å¿—\n3. æŸ¥çœ‹ Network æ ‡ç­¾éªŒè¯ API è°ƒç”¨\n4. éªŒè¯åç«¯æ˜¯å¦è¿”å› conversationId\n\n---\n\n**ç¥ä¿®å¤é¡ºåˆ©ï¼** ğŸ‰\n"